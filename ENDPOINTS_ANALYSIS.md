# üìä –ê–Ω–∞–ª–∏–∑ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ Agent-UI

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ API

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É API —Å —Ç—Ä–µ–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:

1. **Next.js API Routes** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
2. **Agno Framework** - —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏
3. **Messenger Server** - —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞–º–∏
4. **Supabase Database** - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

---

## üîó 1. Next.js API Routes (`/api/v1/*`)

### üë• Agents API

#### `GET /api/v1/agents`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `company_id` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏
  - `is_public` - –ø—É–±–ª–∏—á–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã
  - `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∞–≥–µ–Ω—Ç–æ–≤
  - `limit`, `offset` - –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase (—Ç–∞–±–ª–∏—Ü–∞ agents)

#### `POST /api/v1/agents`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**: –î–∞–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç–∞ (name, description, instructions, etc.)
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase

#### `GET /api/v1/agents/[id]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –ø–æ ID
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase

#### `PUT /api/v1/agents/[id]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase

#### `DELETE /api/v1/agents/[id]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase

#### `GET /api/v1/agents/public`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase (—Ñ–∏–ª—å—Ç—Ä is_public = true)

#### `GET /api/v1/agents/company/[companyId]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–≥–µ–Ω—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase (—Ñ–∏–ª—å—Ç—Ä –ø–æ company_id)

#### `GET /api/v1/agents/company/[companyId]/accessible`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ (–ø—É–±–ª–∏—á–Ω—ã–µ + —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ)
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase

#### `GET /api/v1/agents/search`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–∏—Å–∫ –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å—É
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `q` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase

### üè¢ Companies API

#### `GET /api/v1/companies`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Supabase
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase (—Ñ—É–Ω–∫—Ü–∏—è `get_user_company`)

#### `POST /api/v1/companies`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: Supabase

### üîß Instances API

#### `GET /api/v1/instances`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `provider` - —Ç–∏–ø –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (telegram, whatsapp, etc.)
  - `status` - —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç–∞–Ω—Å–∞
  - `company_id` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏
- **–ü—Ä–æ–∫—Å–∏ –∫**: `13.61.141.6/api/v1/instances`

### üì± Messaging APIs

#### `POST /api/v1/telegram/send`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ Telegram
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "port": "number",
    "instanceId": "string",
    "chatId": "string",
    "message": "string"
  }
  ```
- **–ü—Ä–æ–∫—Å–∏ –∫**: `13.61.141.6:[port]/api/v1/telegram/send`

#### `POST /api/v1/telegram/send-media`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞ —á–µ—Ä–µ–∑ Telegram
- **–ü—Ä–æ–∫—Å–∏ –∫**: `13.61.141.6:[port]/api/v1/telegram/send-media`

#### `POST /api/v1/whatsapp/send`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ WhatsApp
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "port": "number",
    "instanceId": "string",
    "number": "string",
    "message": "string",
    "source": "string", // –¥–ª—è –º–µ–¥–∏–∞
    "mediaType": "text|image|document"
  }
  ```
- **–ü—Ä–æ–∫—Å–∏ –∫**: `13.61.141.6:[port]/api/v1/send`

### üìä Logs API

#### `GET /api/v1/logs`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ Instance Manager
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `tail` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ (1-10000)
  - `level` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (error, warn, info, http, debug)
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–µ—Ä–≤–µ—Ä–∞

#### `GET /api/v1/logs/latest`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `lines` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–µ—Ä–≤–µ—Ä–∞

### üóÑÔ∏è Cache API

#### `POST /api/internal/cache/invalidate`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**: –ö–ª—é—á–∏ –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## ü§ñ 2. Agno Framework API (`localhost:8000/v1/*`)

> **‚ö†Ô∏è –í–ê–ñ–ù–û**: CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ Agno API.
> –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Supabase –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏.

### üéØ Agent Runtime Operations (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫ –∏ —Å–µ—Å—Å–∏–∏)

#### `POST /v1/agents/[id]/runs`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "message": "string",
    "session_id": "string",
    "stream": boolean
  }
  ```
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞

#### `GET /v1/agents/[id]/sessions`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π –∞–≥–µ–Ω—Ç–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: Sidebar –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–∞—Ç–æ–≤

#### `GET /v1/agents/[id]/sessions/[sessionId]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Å–µ—Å—Å–∏—è –∞–≥–µ–Ω—Ç–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞

#### `DELETE /v1/agents/[id]/sessions/[sessionId]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤

### üè• System Operations

#### `GET /v1/health`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è Agno —Å–µ—Ä–≤–µ—Ä–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

---

## üì± 3. Messenger Server API (`13.61.141.6/*`)

### üîß Instance Management

#### `GET /api/v1/instances`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: provider, status, company_id, limit, offset
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: MessengerInstanceManager

#### `POST /api/v1/instances`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (WhatsApp, Telegram, etc.)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä-–±–æ—Ç–æ–≤

#### `GET /api/v1/instances/[id]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–Ω—Å—Ç–∞–Ω—Å–µ
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: MessengerInstanceDetail

#### `PUT /api/v1/instances/[id]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

#### `DELETE /api/v1/instances/[id]`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –£–¥–∞–ª–µ–Ω–∏–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä-–±–æ—Ç–æ–≤

### üì§ Direct Messaging

#### `POST :[port]/api/v1/telegram/send`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Telegram
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: Bearer [instanceId]
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "chatId": "string",
    "message": "string"
  }
  ```

#### `POST :[port]/api/v1/send` (WhatsApp)

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ WhatsApp
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: Bearer [instanceId]
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "number": "string",
    "message": "string",
    "mediaType": "text|image|document"
  }
  ```

### üîó Webhooks

#### `POST /api/v1/telegram/webhook`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: Webhook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Telegram —Å–æ–±—ã—Ç–∏–π
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

#### `POST /api/v1/whatsapp/webhook`

- **–û–ø–∏—Å–∞–Ω–∏–µ**: Webhook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è WhatsApp —Å–æ–±—ã—Ç–∏–π
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üóÑÔ∏è 4. Supabase Database Operations

### üë• Agents CRUD

- **–¢–∞–±–ª–∏—Ü–∞**: `agents`
- **–û–ø–µ—Ä–∞—Ü–∏–∏**: –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `SupabaseCrudClient`
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ü–æ –∫–æ–º–ø–∞–Ω–∏–∏, –ø—É–±–ª–∏—á–Ω–æ—Å—Ç–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- **–ü–æ–∏—Å–∫**: –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –æ–ø–∏—Å–∞–Ω–∏—é

### üõ†Ô∏è Tools CRUD

- **–¢–∞–±–ª–∏—Ü–∞**: `tools`
- **–û–ø–µ—Ä–∞—Ü–∏–∏**: –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `SupabaseCrudClient`
- **–¢–∏–ø—ã**: builtin, custom, mcp
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ü–æ —Ç–∏–ø—É, –∫–æ–º–ø–∞–Ω–∏–∏, –ø—É–±–ª–∏—á–Ω–æ—Å—Ç–∏

### üè¢ Companies Management

- **–¢–∞–±–ª–∏—Ü–∞**: `companies`
- **–§—É–Ω–∫—Ü–∏—è**: `get_user_company(p_user_id)`
- **–ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å**: –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–æ–º–ø–∞–Ω–∏—è–º

---

## üîÑ –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### API Router (`src/lib/apiRouter.ts`)

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤:

```typescript
export const API_ROUTES_MAP: Record<string, APIRoute> = {
  // Agno Framework (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–æ–≤)
  'agents.run': { target: 'agno' },
  'sessions.list': { target: 'agno' },
  'sessions.get': { target: 'agno' },
  'sessions.delete': { target: 'agno' },

  // Instances API
  'instances.list': { target: 'instances' },
  'instances.create': { target: 'instances' },

  // Internal Next.js
  'companies.get': { target: 'internal' },
  'logs.get': { target: 'internal' },

  // Supabase (—á–µ—Ä–µ–∑ SupabaseCrudClient)
  'agents.crud': { target: 'supabase' },
  'tools.crud': { target: 'supabase' }
}
```

### –ö–ª–∏–µ–Ω—Ç—ã API

1. **APIClient** (`src/lib/apiClient.ts`) - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç Supabase)
2. **AgnoAPIClient** (`src/lib/agnoApiClient.ts`) - —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ –∏ —Å–µ—Å—Å–∏–π
3. **SupabaseCrudClient** (`src/lib/supabaseCrudClient.ts`) - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
4. **InstancesAPIClient** (`src/lib/instancesApiClient.ts`) - –∫–ª–∏–µ–Ω—Ç –¥–ª—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤
5. **MessengerAPIClient** (`src/lib/messengerApi.ts`) - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:

- **Agents API**: 10 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (CRUD + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è) - **Supabase**
- **Agno Framework**: 5 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫ –∏ —Å–µ—Å—Å–∏–∏) - **–°–æ–∫—Ä–∞—â–µ–Ω–æ**
- **Messenger Server**: 15+ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (–∏–Ω—Å—Ç–∞–Ω—Å—ã, –æ—Ç–ø—Ä–∞–≤–∫–∞, webhooks)
- **Internal APIs**: 8 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (–∫–æ–º–ø–∞–Ω–∏–∏, –ª–æ–≥–∏, –∫—ç—à)

### –ü–æ —Ç–∏–ø–∞–º –æ–ø–µ—Ä–∞—Ü–∏–π:

- **GET**: ~65% (–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- **POST**: ~30% (—Å–æ–∑–¥–∞–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–∫–∞, –∑–∞–ø—É—Å–∫)
- **PUT/DELETE**: ~5% (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### Supabase Auth

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è Next.js API routes –∏ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- JWT —Ç–æ–∫–µ–Ω—ã –≤ cookies
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `supabase.auth.getUser()`

### Bearer Token Auth

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –∏–Ω—Å—Ç–∞–Ω—Å–∞–º
- `Authorization: Bearer [instanceId]`

### Company-based Access Control

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ `company_id`
- –ü—É–±–ª–∏—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º (`is_public: true`)
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º

---

## ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

### –£–¥–∞–ª–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã Agno Framework:

‚ùå **–£–¥–∞–ª–µ–Ω–æ (—Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑ Supabase):**

- `GET /v1/agents` - —Å–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤
- `GET /v1/agents/detailed` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `GET /v1/agents/public` - –ø—É–±–ª–∏—á–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã
- `GET /v1/agents/company/[companyId]` - –∞–≥–µ–Ω—Ç—ã –∫–æ–º–ø–∞–Ω–∏–∏
- `GET /v1/agents/company/[companyId]/accessible` - –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã
- `GET /v1/agents/search` - –ø–æ–∏—Å–∫ –∞–≥–µ–Ω—Ç–æ–≤
- `POST /v1/agents/[id]/cache/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞
- `GET /v1/tools` - —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- `GET /v1/tools/custom` - –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- `GET /v1/tools/mcp` - MCP —Å–µ—Ä–≤–µ—Ä—ã
- `GET /v1/tools/mcp/[serverId]/tools` - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã MCP
- `GET /v1/tools/public` - –ø—É–±–ª–∏—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- `GET /v1/tools/company/[companyId]/accessible` - –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- `GET /v1/tools/search` - –ø–æ–∏—Å–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- `GET /v1/models` - —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π

‚úÖ **–û—Å—Ç–∞–≤–ª–µ–Ω–æ (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã):**

- `POST /v1/agents/[id]/runs` - –∑–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞
- `GET /v1/agents/[id]/sessions` - —Å–µ—Å—Å–∏–∏ –∞–≥–µ–Ω—Ç–∞
- `GET /v1/agents/[id]/sessions/[sessionId]` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Å–µ—Å—Å–∏—è
- `DELETE /v1/agents/[id]/sessions/[sessionId]` - —É–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- `GET /v1/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ Supabase
2. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–ª—è –≤—Å–µ—Ö Supabase –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
4. **Rate Limiting**: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –≤–Ω–µ—à–Ω–∏–º API
5. **Error Handling**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –≤–æ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö
6. **Database Optimization**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ Supabase —Å –ø–æ–º–æ—â—å—é –∏–Ω–¥–µ–∫—Å–æ–≤
